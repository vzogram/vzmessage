<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VZMessage</title>
    <style>
        :root {
            --primary-color: #8a2be2;
            --secondary-color: #9932cc;
            --accent-color: #ba55d3;
            --background-color: #1a1a2e;
            --chat-bg: #16213e;
            --message-sent: #8a2be2;
            --message-received: #2d2d44;
            --text-color: #ffffff;
            --border-color: #4a4a6a;
            --hover-color: #7b1fa2;
            --error-color: #ff3860;
            --success-color: #23d160;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
        }

        /* Анимации */
        @keyframes neon-glow {
            0%, 100% { box-shadow: 0 0 5px var(--primary-color), 0 0 10px var(--primary-color), 0 0 15px var(--primary-color); }
            50% { box-shadow: 0 0 10px var(--accent-color), 0 0 20px var(--accent-color), 0 0 30px var(--accent-color); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Страница авторизации */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, var(--background-color) 0%, #0f3460 100%);
        }

        .auth-box {
            background-color: var(--chat-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.3);
            animation: fadeIn 0.5s ease-out;
        }

        .auth-title {
            text-align: center;
            margin-bottom: 25px;
            font-size: 28px;
            color: var(--primary-color);
            text-shadow: 0 0 10px var(--primary-color);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-tab.active {
            border-bottom: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: var(--background-color);
            color: var(--text-color);
            outline: none;
            transition: all 0.3s;
        }

        .form-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 8px var(--primary-color);
        }

        .auth-button {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .auth-button:hover {
            background-color: var(--secondary-color);
            animation: neon-glow 1.5s infinite;
        }

        .error-message {
            color: var(--error-color);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        /* Основной интерфейс мессенджера */
        .container {
            display: flex;
            height: 100%;
        }

        .sidebar {
            width: 30%;
            background-color: var(--chat-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .profile-header {
            padding: 15px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--primary-color);
        }

        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .profile-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px var(--accent-color);
        }

        .profile-info {
            flex: 1;
        }

        .profile-nickname {
            font-weight: bold;
            font-size: 16px;
        }

        .profile-username {
            font-size: 12px;
            opacity: 0.7;
        }

        .menu-button {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .menu-button:hover {
            background-color: var(--hover-color);
            box-shadow: 0 0 8px var(--accent-color);
        }

        .search-container {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .search-input {
            width: 100%;
            padding: 10px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            background-color: var(--background-color);
            color: var(--text-color);
            outline: none;
            transition: box-shadow 0.3s;
        }

        .search-input:focus {
            box-shadow: 0 0 8px var(--accent-color);
        }

        .chats-list {
            flex: 1;
            overflow-y: auto;
        }

        .chat-item {
            padding: 15px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .chat-item:hover {
            background-color: var(--hover-color);
        }

        .chat-item.active {
            background-color: var(--secondary-color);
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .chat-info {
            flex: 1;
        }

        .chat-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .chat-last-message {
            font-size: 14px;
            opacity: 0.7;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .new-chat-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            z-index: 100;
        }

        .new-chat-button:hover {
            transform: scale(1.1);
            animation: neon-glow 1.5s infinite;
        }

        /* Область чата */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            background-color: var(--chat-bg);
        }

        .chat-title {
            font-weight: bold;
            font-size: 18px;
        }

        .chat-actions {
            margin-left: auto;
        }

        .action-button {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 18px;
            cursor: pointer;
            margin-left: 10px;
            padding: 5px;
            border-radius: 5px;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .action-button:hover {
            background-color: var(--hover-color);
            box-shadow: 0 0 8px var(--accent-color);
        }

        .messages-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: var(--background-color);
        }

        .message {
            margin-bottom: 15px;
            max-width: 70%;
            animation: fadeIn 0.3s ease-out;
        }

        .message.sent {
            margin-left: auto;
            text-align: right;
        }

        .message-content {
            padding: 10px 15px;
            border-radius: 18px;
            display: inline-block;
            word-wrap: break-word;
        }

        .message.sent .message-content {
            background-color: var(--message-sent);
            border-bottom-right-radius: 5px;
        }

        .message.received .message-content {
            background-color: var(--message-received);
            border-bottom-left-radius: 5px;
        }

        .message-sender {
            font-size: 12px;
            margin-bottom: 5px;
            opacity: 0.7;
        }

        .message-time {
            font-size: 11px;
            margin-top: 5px;
            opacity: 0.6;
        }

        .input-area {
            padding: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            background-color: var(--chat-bg);
        }

        .message-input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 25px;
            border: 1px solid var(--border-color);
            background-color: var(--background-color);
            color: var(--text-color);
            outline: none;
            resize: none;
            transition: box-shadow 0.3s;
        }

        .message-input:focus {
            box-shadow: 0 0 8px var(--accent-color);
        }

        .send-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .send-button:hover {
            background-color: var(--secondary-color);
            animation: neon-glow 1.5s infinite;
        }

        /* Модальные окна */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background-color: var(--chat-bg);
            padding: 25px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.5);
        }

        .modal-title {
            margin-bottom: 20px;
            font-size: 22px;
            color: var(--primary-color);
            text-align: center;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .modal-button {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s;
        }

        .modal-button.primary {
            background-color: var(--primary-color);
            color: white;
        }

        .modal-button.primary:hover {
            background-color: var(--secondary-color);
            animation: neon-glow 1.5s infinite;
        }

        .modal-button.secondary {
            background-color: var(--border-color);
            color: var(--text-color);
        }

        .file-input {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 10px 15px;
            background-color: var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-right: 10px;
        }

        .file-label:hover {
            background-color: var(--hover-color);
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                display: none;
            }
            
            .sidebar.active {
                display: flex;
            }
            
            .chat-area {
                display: none;
            }
            
            .chat-area.active {
                display: flex;
            }
            
            .menu-button.mobile-toggle {
                display: block;
            }
            
            .message {
                max-width: 85%;
            }
        }

        @media (min-width: 769px) {
            .menu-button.mobile-toggle {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Страница авторизации -->
    <div id="authPage" class="auth-container">
        <div class="auth-box">
            <h1 class="auth-title">VZMessage</h1>
            <div class="auth-tabs">
                <div class="auth-tab active" data-tab="login">Вход</div>
                <div class="auth-tab" data-tab="register">Регистрация</div>
            </div>
            
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <input type="email" id="loginEmail" class="form-input" placeholder="Email" required>
                    <div class="error-message" id="loginEmailError"></div>
                </div>
                <div class="form-group">
                    <input type="password" id="loginPassword" class="form-input" placeholder="Пароль" required>
                    <div class="error-message" id="loginPasswordError"></div>
                </div>
                <button type="submit" class="auth-button">Войти</button>
            </form>
            
            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <input type="email" id="registerEmail" class="form-input" placeholder="Email" required>
                    <div class="error-message" id="registerEmailError"></div>
                </div>
                <div class="form-group">
                    <input type="text" id="registerNickname" class="form-input" placeholder="Никнейм" required>
                    <div class="error-message" id="registerNicknameError"></div>
                </div>
                <div class="form-group">
                    <input type="text" id="registerUsername" class="form-input" placeholder="Username (только английские буквы и цифры)" required>
                    <div class="error-message" id="registerUsernameError"></div>
                </div>
                <div class="form-group">
                    <input type="password" id="registerPassword" class="form-input" placeholder="Пароль" required>
                    <div class="error-message" id="registerPasswordError"></div>
                </div>
                <div class="form-group">
                    <input type="password" id="registerConfirmPassword" class="form-input" placeholder="Подтвердите пароль" required>
                    <div class="error-message" id="registerConfirmPasswordError"></div>
                </div>
                <button type="submit" class="auth-button">Зарегистрироваться</button>
            </form>
        </div>
    </div>

    <!-- Основной интерфейс мессенджера -->
    <div id="app" class="container" style="display: none;">
        <!-- Сайдбар с чатами -->
        <div class="sidebar" id="sidebar">
            <div class="profile-header">
                <img src="" alt="Аватар" class="profile-avatar" id="profileAvatar">
                <div class="profile-info">
                    <div class="profile-nickname" id="profileNickname"></div>
                    <div class="profile-username" id="profileUsername"></div>
                </div>
                <button class="menu-button" id="profileMenu">☰</button>
                <button class="menu-button mobile-toggle" id="toggleSidebar">←</button>
            </div>
            
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Поиск по username...">
            </div>
            
            <div class="chats-list" id="chatsList">
                <!-- Список чатов будет здесь -->
            </div>
        </div>
        
        <!-- Область чата -->
        <div class="chat-area" id="chatArea">
            <div class="chat-header">
                <button class="menu-button mobile-toggle" id="toggleChatArea">☰</button>
                <div class="chat-title" id="chatTitle">Выберите чат</div>
                <div class="chat-actions">
                    <button class="action-button" id="chatInfoButton" title="Информация о чате">ℹ️</button>
                    <button class="action-button" id="deleteChatButton" title="Удалить чат">🗑️</button>
                </div>
            </div>
            
            <div class="messages-container" id="messagesContainer">
                <!-- Сообщения будут здесь -->
                <div class="welcome-message">
                    <p>Добро пожаловать в VZMessage!</p>
                    <p>Выберите чат для начала общения.</p>
                </div>
            </div>
            
            <div class="input-area">
                <input type="file" id="fileInput" class="file-input">
                <label for="fileInput" class="file-label">📎</label>
                <textarea class="message-input" id="messageInput" placeholder="Введите сообщение..." rows="1"></textarea>
                <button class="send-button" id="sendButton">➤</button>
            </div>
        </div>
        
        <button class="new-chat-button" id="newChatButton">+</button>
    </div>

    <!-- Модальное окно профиля -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <h2 class="modal-title">Настройки профиля</h2>
            <div class="form-group">
                <label>Аватарка:</label>
                <input type="file" id="avatarUpload" accept="image/*">
                <div id="avatarPreview"></div>
            </div>
            <div class="form-group">
                <label>Никнейм:</label>
                <input type="text" id="profileNicknameInput" class="form-input">
            </div>
            <div class="form-group">
                <label>Username:</label>
                <input type="text" id="profileUsernameInput" class="form-input">
            </div>
            <div class="modal-buttons">
                <button class="modal-button secondary" id="closeProfileModal">Отмена</button>
                <button class="modal-button primary" id="saveProfile">Сохранить</button>
                <button class="modal-button secondary" id="logoutButton">Выйти</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно нового чата -->
    <div class="modal" id="newChatModal">
        <div class="modal-content">
            <h2 class="modal-title">Новый чат</h2>
            <div class="form-group">
                <label>Тип чата:</label>
                <select id="chatType" class="form-input">
                    <option value="private">Личный чат</option>
                    <option value="group">Групповой чат</option>
                </select>
            </div>
            <div class="form-group" id="usernameSearchGroup">
                <label>Поиск пользователя:</label>
                <input type="text" id="searchUsername" class="form-input" placeholder="Введите username">
                <div id="searchResults"></div>
            </div>
            <div class="form-group" id="groupSettings" style="display: none;">
                <label>Название группы:</label>
                <input type="text" id="groupName" class="form-input" placeholder="Введите название группы">
                <label>Аватар группы:</label>
                <input type="file" id="groupAvatarUpload" accept="image/*">
                <div id="groupAvatarPreview"></div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button secondary" id="closeNewChatModal">Отмена</button>
                <button class="modal-button primary" id="createChatButton">Создать</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно информации о чате -->
    <div class="modal" id="chatInfoModal">
        <div class="modal-content">
            <h2 class="modal-title" id="chatInfoTitle">Информация о чате</h2>
            <div id="chatInfoContent">
                <!-- Информация о чате будет здесь -->
            </div>
            <div class="modal-buttons">
                <button class="modal-button primary" id="closeChatInfoModal">Закрыть</button>
            </div>
        </div>
    </div>

    <script>
        // Глобальные переменные
        let currentUser = null;
        let users = {};
        let chats = {};
        let currentChatId = null;

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Загружаем данные из localStorage
            loadData();
            
            // Проверяем, авторизован ли пользователь
            if (currentUser) {
                showApp();
            } else {
                showAuth();
            }
            
            // Настройка обработчиков событий
            setupEventListeners();
        });

        // Загрузка данных из localStorage
        function loadData() {
            const savedUsers = localStorage.getItem('vzmessage_users');
            const savedChats = localStorage.getItem('vzmessage_chats');
            const savedCurrentUser = localStorage.getItem('vzmessage_currentUser');
            
            if (savedUsers) {
                users = JSON.parse(savedUsers);
            }
            
            if (savedChats) {
                chats = JSON.parse(savedChats);
            }
            
            if (savedCurrentUser) {
                currentUser = JSON.parse(savedCurrentUser);
            }
        }

        // Сохранение данных в localStorage
        function saveData() {
            localStorage.setItem('vzmessage_users', JSON.stringify(users));
            localStorage.setItem('vzmessage_chats', JSON.stringify(chats));
            if (currentUser) {
                localStorage.setItem('vzmessage_currentUser', JSON.stringify(currentUser));
            }
        }

        // Показать страницу авторизации
        function showAuth() {
            document.getElementById('authPage').style.display = 'flex';
            document.getElementById('app').style.display = 'none';
        }

        // Показать основное приложение
        function showApp() {
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('app').style.display = 'flex';
            
            // Обновляем интерфейс
            updateProfileInfo();
            updateChatsList();
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Переключение между вкладками входа и регистрации
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(this.dataset.tab + 'Form').classList.add('active');
                });
            });
            
            // Обработка формы входа
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                loginUser();
            });
            
            // Обработка формы регистрации
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                registerUser();
            });
            
            // Кнопка меню профиля
            document.getElementById('profileMenu').addEventListener('click', function() {
                document.getElementById('profileModal').classList.add('active');
                loadProfileData();
            });
            
            // Кнопка нового чата
            document.getElementById('newChatButton').addEventListener('click', function() {
                document.getElementById('newChatModal').classList.add('active');
            });
            
            // Переключение типа чата
            document.getElementById('chatType').addEventListener('change', function() {
                const isGroup = this.value === 'group';
                document.getElementById('usernameSearchGroup').style.display = isGroup ? 'none' : 'block';
                document.getElementById('groupSettings').style.display = isGroup ? 'block' : 'none';
            });
            
            // Поиск пользователей
            document.getElementById('searchUsername').addEventListener('input', function() {
                searchUsers(this.value);
            });
            
            // Создание чата
            document.getElementById('createChatButton').addEventListener('click', createChat);
            
            // Закрытие модальных окон
            document.getElementById('closeProfileModal').addEventListener('click', function() {
                document.getElementById('profileModal').classList.remove('active');
            });
            
            document.getElementById('closeNewChatModal').addEventListener('click', function() {
                document.getElementById('newChatModal').classList.remove('active');
            });
            
            document.getElementById('closeChatInfoModal').addEventListener('click', function() {
                document.getElementById('chatInfoModal').classList.remove('active');
            });
            
            // Сохранение профиля
            document.getElementById('saveProfile').addEventListener('click', saveProfile);
            
            // Выход из аккаунта
            document.getElementById('logoutButton').addEventListener('click', logout);
            
            // Отправка сообщения
            document.getElementById('sendButton').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // Загрузка файла
            document.getElementById('fileInput').addEventListener('change', handleFileUpload);
            
            // Информация о чате
            document.getElementById('chatInfoButton').addEventListener('click', showChatInfo);
            
            // Удаление чата
            document.getElementById('deleteChatButton').addEventListener('click', deleteChat);
            
            // Мобильное переключение
            document.getElementById('toggleSidebar').addEventListener('click', function() {
                document.getElementById('sidebar').classList.remove('active');
                document.getElementById('chatArea').classList.add('active');
            });
            
            document.getElementById('toggleChatArea').addEventListener('click', function() {
                document.getElementById('chatArea').classList.remove('active');
                document.getElementById('sidebar').classList.add('active');
            });
        }

        // Регистрация пользователя
        function registerUser() {
            const email = document.getElementById('registerEmail').value;
            const nickname = document.getElementById('registerNickname').value;
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            // Валидация
            let isValid = true;
            
            // Проверка email
            if (!isValidEmail(email)) {
                showError('registerEmailError', 'Введите корректный email');
                isValid = false;
            } else {
                hideError('registerEmailError');
            }
            
            // Проверка никнейма
            if (nickname.length < 2) {
                showError('registerNicknameError', 'Никнейм должен содержать минимум 2 символа');
                isValid = false;
            } else {
                hideError('registerNicknameError');
            }
            
            // Проверка username
            if (!isValidUsername(username)) {
                showError('registerUsernameError', 'Username может содержать только английские буквы и цифры');
                isValid = false;
            } else if (users[username]) {
                showError('registerUsernameError', 'Этот username уже занят');
                isValid = false;
            } else {
                hideError('registerUsernameError');
            }
            
            // Проверка пароля
            if (password.length < 6) {
                showError('registerPasswordError', 'Пароль должен содержать минимум 6 символов');
                isValid = false;
            } else {
                hideError('registerPasswordError');
            }
            
            // Проверка подтверждения пароля
            if (password !== confirmPassword) {
                showError('registerConfirmPasswordError', 'Пароли не совпадают');
                isValid = false;
            } else {
                hideError('registerConfirmPasswordError');
            }
            
            if (!isValid) return;
            
            // Создание пользователя
            users[username] = {
                email: email,
                nickname: nickname,
                username: username,
                password: password, // В реальном приложении пароль должен хешироваться!
                avatar: null,
                chats: []
            };
            
            // Сохраняем данные
            saveData();
            
            // Автоматический вход
            currentUser = users[username];
            saveData();
            showApp();
            
            // Очищаем форму
            document.getElementById('registerForm').reset();
        }

        // Вход пользователя
        function loginUser() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Поиск пользователя по email
            let user = null;
            for (const username in users) {
                if (users[username].email === email) {
                    user = users[username];
                    break;
                }
            }
            
            // Проверка учетных данных
            if (!user) {
                showError('loginEmailError', 'Пользователь с таким email не найден');
                return;
            } else {
                hideError('loginEmailError');
            }
            
            if (user.password !== password) {
                showError('loginPasswordError', 'Неверный пароль');
                return;
            } else {
                hideError('loginPasswordError');
            }
            
            // Успешный вход
            currentUser = user;
            saveData();
            showApp();
            
            // Очищаем форму
            document.getElementById('loginForm').reset();
        }

        // Выход из аккаунта
        function logout() {
            currentUser = null;
            saveData();
            showAuth();
            document.getElementById('profileModal').classList.remove('active');
        }

        // Обновление информации профиля в интерфейсе
        function updateProfileInfo() {
            if (!currentUser) return;
            
            document.getElementById('profileNickname').textContent = currentUser.nickname;
            document.getElementById('profileUsername').textContent = '@' + currentUser.username;
            
            if (currentUser.avatar) {
                document.getElementById('profileAvatar').src = currentUser.avatar;
            } else {
                document.getElementById('profileAvatar').src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM4YTJiZTIiLz4KPHN2ZyB4PSIxMCIgeT0iMTAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIiBmaWxsPSJ3aGl0ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDBDMTEuMzMgMCAxMi40MyAwLjY3IDEzLjE3IDEuNjVDMTMuOTMgMi42MyAxNC4zMyAzLjg3IDE0LjMzIDUuMzNDMTQuMzMgNi44IDEzLjkzIDggMTMuMTcgOUMyNC0yIDEyLjQzIDEwIDEwIDEwQzcuNTcgMTAgNiA4LjQzIDYgNkM2IDMuNTcgNy41NyAyIDEwIDJaTTEwIDEyQzEzLjMzIDEyIDE2IDE0LjY3IDE2IDE4SDRDNCwxNC42NyA2LjY3IDEyIDEwIDEyWiIvPgo8L3N2Zz4KPC9zdmc+';
            }
        }

        // Загрузка данных профиля в модальное окно
        function loadProfileData() {
            if (!currentUser) return;
            
            document.getElementById('profileNicknameInput').value = currentUser.nickname;
            document.getElementById('profileUsernameInput').value = currentUser.username;
            
            const avatarPreview = document.getElementById('avatarPreview');
            if (currentUser.avatar) {
                avatarPreview.innerHTML = `<img src="${currentUser.avatar}" alt="Аватар" style="width: 100px; height: 100px; border-radius: 50%;">`;
            } else {
                avatarPreview.innerHTML = '';
            }
        }

        // Сохранение профиля
        function saveProfile() {
            if (!currentUser) return;
            
            const newNickname = document.getElementById('profileNicknameInput').value;
            const newUsername = document.getElementById('profileUsernameInput').value;
            
            // Валидация
            if (newNickname.length < 2) {
                alert('Никнейм должен содержать минимум 2 символа');
                return;
            }
            
            if (!isValidUsername(newUsername)) {
                alert('Username может содержать только английские буквы и цифры');
                return;
            }
            
            // Проверка на уникальность username
            if (newUsername !== currentUser.username && users[newUsername]) {
                alert('Этот username уже занят');
                return;
            }
            
            // Обновление аватара
            const avatarFile = document.getElementById('avatarUpload').files[0];
            if (avatarFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentUser.avatar = e.target.result;
                    updateUserData();
                };
                reader.readAsDataURL(avatarFile);
            } else {
                updateUserData();
            }
            
            function updateUserData() {
                // Обновляем данные пользователя
                if (newUsername !== currentUser.username) {
                    // Удаляем старый username и создаем новый
                    delete users[currentUser.username];
                    users[newUsername] = currentUser;
                }
                
                currentUser.nickname = newNickname;
                currentUser.username = newUsername;
                
                // Обновляем ссылки в чатах
                for (const chatId in chats) {
                    const chat = chats[chatId];
                    if (chat.participants.includes(currentUser.username)) {
                        // Обновляем никнейм в сообщениях
                        chat.messages.forEach(message => {
                            if (message.sender === currentUser.username) {
                                message.senderNickname = newNickname;
                            }
                        });
                    }
                }
                
                saveData();
                updateProfileInfo();
                updateChatsList();
                document.getElementById('profileModal').classList.remove('active');
            }
        }

        // Поиск пользователей
        function searchUsers(query) {
            const resultsContainer = document.getElementById('searchResults');
            resultsContainer.innerHTML = '';
            
            if (query.length < 1) return;
            
            const results = [];
            for (const username in users) {
                if (username.includes(query) && username !== currentUser.username) {
                    results.push(users[username]);
                }
            }
            
            if (results.length === 0) {
                resultsContainer.innerHTML = '<p>Пользователи не найдены</p>';
                return;
            }
            
            results.forEach(user => {
                const userElement = document.createElement('div');
                userElement.className = 'chat-item';
                userElement.innerHTML = `
                    <img src="${user.avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM4YTJiZTIiLz4KPHN2ZyB4PSIxMCIgeT0iMTAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIiBmaWxsPSJ3aGl0ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDBDMTEuMzMgMCAxMi40MyAwLjY3IDEzLjE3IDEuNjVDMTMuOTMgMi42MyAxNC4zMyAzLjg3IDE0LjMzIDUuMzNDMTQuMzMgNi44IDEzLjkzIDggMTMuMTcgOUMyNC0yIDEyLjQzIDEwIDEwIDEwQzcuNTcgMTAgNiA4LjQzIDYgNkM2IDMuNTcgNy41NyAyIDEwIDJaTTEwIDEyQzEzLjMzIDEyIDE2IDE0LjY3IDE2IDE4SDRDNCwxNC42NyA2LjY3IDEyIDEwIDEyWiIvPgo8L3N2Zz4KPC9zdmc+'}" alt="Аватар" class="chat-avatar">
                    <div class="chat-info">
                        <div class="chat-name">${user.nickname}</div>
                        <div class="chat-last-message">@${user.username}</div>
                    </div>
                `;
                userElement.addEventListener('click', function() {
                    createPrivateChat(user.username);
                });
                resultsContainer.appendChild(userElement);
            });
        }

        // Создание приватного чата
        function createPrivateChat(username) {
            const chatId = [currentUser.username, username].sort().join('_');
            
            if (!chats[chatId]) {
                chats[chatId] = {
                    id: chatId,
                    type: 'private',
                    participants: [currentUser.username, username],
                    messages: [],
                    title: users[username].nickname,
                    avatar: users[username].avatar
                };
                
                // Добавляем чат пользователям
                users[currentUser.username].chats.push(chatId);
                users[username].chats.push(chatId);
                
                saveData();
            }
            
            // Открываем чат
            openChat(chatId);
            document.getElementById('newChatModal').classList.remove('active');
        }

        // Создание группового чата
        function createGroupChat() {
            const groupName = document.getElementById('groupName').value;
            
            if (!groupName) {
                alert('Введите название группы');
                return;
            }
            
            const chatId = 'group_' + Date.now();
            const participants = [currentUser.username];
            
            // Здесь можно добавить логику для выбора участников группы
            // В демо-версии просто создаем группу с текущим пользователем
            
            chats[chatId] = {
                id: chatId,
                type: 'group',
                participants: participants,
                messages: [],
                title: groupName,
                avatar: null,
                admin: currentUser.username
            };
            
            // Обновляем аватар, если выбран
            const avatarFile = document.getElementById('groupAvatarUpload').files[0];
            if (avatarFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    chats[chatId].avatar = e.target.result;
                    saveData();
                };
                reader.readAsDataURL(avatarFile);
            }
            
            // Добавляем чат пользователям
            participants.forEach(username => {
                if (users[username]) {
                    users[username].chats.push(chatId);
                }
            });
            
            saveData();
            
            // Открываем чат
            openChat(chatId);
            document.getElementById('newChatModal').classList.remove('active');
        }

        // Создание чата (общая функция)
        function createChat() {
            const chatType = document.getElementById('chatType').value;
            
            if (chatType === 'private') {
                // Для приватного чата нужен выбранный пользователь
                // В демо-версии просто создаем чат с первым найденным пользователем
                for (const username in users) {
                    if (username !== currentUser.username) {
                        createPrivateChat(username);
                        return;
                    }
                }
                alert('Нет других пользователей для создания чата');
            } else {
                createGroupChat();
            }
        }

        // Обновление списка чатов
        function updateChatsList() {
            if (!currentUser) return;
            
            const chatsList = document.getElementById('chatsList');
            chatsList.innerHTML = '';
            
            currentUser.chats.forEach(chatId => {
                const chat = chats[chatId];
                if (!chat) return;
                
                const lastMessage = chat.messages.length > 0 ? 
                    chat.messages[chat.messages.length - 1] : 
                    { text: 'Нет сообщений', time: Date.now() };
                
                const chatElement = document.createElement('div');
                chatElement.className = 'chat-item' + (currentChatId === chatId ? ' active' : '');
                chatElement.dataset.chatId = chatId;
                
                // Определяем заголовок чата
                let chatTitle = chat.title;
                if (chat.type === 'private') {
                    const otherUser = chat.participants.find(p => p !== currentUser.username);
                    if (users[otherUser]) {
                        chatTitle = users[otherUser].nickname;
                    }
                }
                
                chatElement.innerHTML = `
                    <img src="${chat.avatar || (chat.type === 'private' ? 
                        (users[chat.participants.find(p => p !== currentUser.username)]?.avatar || 
                         'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM4YTJiZTIiLz4KPHN2ZyB4PSIxMCIgeT0iMTAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIiBmaWxsPSJ3aGl0ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDBDMTEuMzMgMCAxMi40MyAwLjY3IDEzLjE3IDEuNjVDMTMuOTMgMi42MyAxNC4zMyAzLjg3IDE0LjMzIDUuMzNDMTQuMzMgNi44IDEzLjkzIDggMTMuMTcgOUMyNC0yIDEyLjQzIDEwIDEwIDEwQzcuNTcgMTAgNiA4LjQzIDYgNkM2IDMuNTcgNy41NyAyIDEwIDJaTTEwIDEyQzEzLjMzIDEyIDE2IDE0LjY3IDE6IDE4SDRDNCwxNC42NyA2LjY3IDEyIDEwIDEyWiIvPgo8L3N2Zz4KPC9zdmc+') : 
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM4YTJiZTIiLz4KPHN2ZyB4PSIxMCIgeT0iMTAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIiBmaWxsPSJ3aGl0ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDBDMTEuMzMgMCAxMi40MyAwLjY3IDEzLjE3IDEuNjVDMTMuOTMgMi42MyAxNC4zMyAzLjg3IDE0LjMzIDUuMzNDMTQuMzMgNi44IDEzLjkzIDggMTMuMTcgOUMyNC0yIDEyLjQzIDEwIDEwIDEwQzcuNTcgMTAgNiA4LjQzIDYgNkM2IDMuNTcgNy41NyAyIDEwIDJaTTEwIDEyQzEzLjMzIDEyIDE2IDE0LjY3IDE2IDE4SDRDNCwxNC42NyA2LjY3IDEyIDEwIDEyWiIvPgo8L3N2Zz4KPC9zdmc+')}" 
                        alt="Аватар" class="chat-avatar">
                    <div class="chat-info">
                        <div class="chat-name">${chatTitle}</div>
                        <div class="chat-last-message">${lastMessage.text || 'Нет сообщений'}</div>
                    </div>
                `;
                
                chatElement.addEventListener('click', function() {
                    openChat(chatId);
                });
                
                chatsList.appendChild(chatElement);
            });
        }

        // Открытие чата
        function openChat(chatId) {
            currentChatId = chatId;
            const chat = chats[chatId];
            
            if (!chat) return;
            
            // Обновляем заголовок чата
            let chatTitle = chat.title;
            if (chat.type === 'private') {
                const otherUser = chat.participants.find(p => p !== currentUser.username);
                if (users[otherUser]) {
                    chatTitle = users[otherUser].nickname;
                }
            }
            document.getElementById('chatTitle').textContent = chatTitle;
            
            // Обновляем список сообщений
            updateMessages();
            
            // Обновляем активный чат в списке
            document.querySelectorAll('.chat-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.chatId === chatId) {
                    item.classList.add('active');
                }
            });
            
            // На мобильных устройствах переключаемся на область чата
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('active');
                document.getElementById('chatArea').classList.add('active');
            }
        }

        // Обновление сообщений в чате
        function updateMessages() {
            const messagesContainer = document.getElementById('messagesContainer');
            messagesContainer.innerHTML = '';
            
            if (!currentChatId || !chats[currentChatId]) {
                messagesContainer.innerHTML = `
                    <div class="welcome-message">
                        <p>Добро пожаловать в VZMessage!</p>
                        <p>Выберите чат для начала общения.</p>
                    </div>
                `;
                return;
            }
            
            const chat = chats[currentChatId];
            
            if (chat.messages.length === 0) {
                messagesContainer.innerHTML = `
                    <div class="welcome-message">
                        <p>Чат "${chat.title}"</p>
                        <p>Начните общение, отправив первое сообщение!</p>
                    </div>
                `;
                return;
            }
            
            chat.messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${message.sender === currentUser.username ? 'sent' : 'received'}`;
                
                let messageContent = '';
                if (message.type === 'file') {
                    messageContent = `
                        <div class="message-sender">${message.senderNickname || users[message.sender]?.nickname || message.sender}</div>
                        <div class="message-content">
                            <a href="${message.fileUrl}" download="${message.fileName}">📎 ${message.fileName}</a>
                        </div>
                    `;
                } else {
                    messageContent = `
                        <div class="message-sender">${message.senderNickname || users[message.sender]?.nickname || message.sender}</div>
                        <div class="message-content">${message.text}</div>
                    `;
                }
                
                messageElement.innerHTML = messageContent + `
                    <div class="message-time">${formatTime(message.time)}</div>
                `;
                
                messagesContainer.appendChild(messageElement);
            });
            
            // Прокручиваем к последнему сообщению
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Отправка сообщения
        function sendMessage() {
            if (!currentChatId) {
                alert('Выберите чат для отправки сообщения');
                return;
            }
            
            const messageInput = document.getElementById('messageInput');
            const text = messageInput.value.trim();
            
            if (!text) return;
            
            const message = {
                id: Date.now(),
                text: text,
                sender: currentUser.username,
                senderNickname: currentUser.nickname,
                time: Date.now(),
                type: 'text'
            };
            
            // Добавляем сообщение в чат
            chats[currentChatId].messages.push(message);
            
            // Сохраняем данные
            saveData();
            
            // Обновляем интерфейс
            updateMessages();
            updateChatsList();
            
            // Очищаем поле ввода
            messageInput.value = '';
        }

        // Обработка загрузки файла
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file || !currentChatId) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const message = {
                    id: Date.now(),
                    fileName: file.name,
                    fileUrl: e.target.result,
                    sender: currentUser.username,
                    senderNickname: currentUser.nickname,
                    time: Date.now(),
                    type: 'file'
                };
                
                // Добавляем сообщение в чат
                chats[currentChatId].messages.push(message);
                
                // Сохраняем данные
                saveData();
                
                // Обновляем интерфейс
                updateMessages();
                updateChatsList();
            };
            reader.readAsDataURL(file);
            
            // Сбрасываем значение input
            e.target.value = '';
        }

        // Показать информацию о чате
        function showChatInfo() {
            if (!currentChatId) {
                alert('Выберите чат для просмотра информации');
                return;
            }
            
            const chat = chats[currentChatId];
            const chatInfoContent = document.getElementById('chatInfoContent');
            
            let content = '';
            
            if (chat.type === 'private') {
                const otherUser = chat.participants.find(p => p !== currentUser.username);
                const user = users[otherUser];
                
                content = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="${user.avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiM4YTJiZTIiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSJ3aGl0ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIwIDBDMjIuNjYgMCAyNC44NiAxLjM0IDI2LjM0IDMuM0MyNy44NiA1LjI2IDI4LjY2IDcuNzQgMjguNjYgMTAuNjZDMjguNjYgMTMuNiAyNy44NiAxNiAyNi4zNCAxOEM0OC00IDI0Ljg2IDIwIDIwIDIwQzE1LjE0IDIwIDEyIDE2Ljg2IDEyIDEyQzEyIDcuMTQgMTUuMTQgNCAyMCA0Wk0yMCAyNEMyNi42NiAyNCAzMiAyOS4zNCAzMiIDM2SDhDOCwyOS4zNCAxMy4zNCAyNCAyMCAyNFoiLz4KPC9zdmc+Cjwvc3ZnPg=='}" 
                             alt="Аватар" style="width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px;">
                        <h3>${user.nickname}</h3>
                        <p>@${user.username}</p>
                    </div>
                `;
            } else {
                content = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="${chat.avatar || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiM4YTJiZTIiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSJ3aGl0ZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIwIDBDMjIuNjYgMCAyNC44NiAxLjM0IDI2LjM0IDMuM0MyNy44NiA1LjI2IDI4LjY2IDcuNzQgMjguNjYgMTAuNjZDMjguNjYgMTMuNiAyNy44NiAxNiAyNi4zNCAxOEM0OC00IDI0Ljg2IDIwIDIwIDIwQzE1LjE0IDIwIDEyIDE2Ljg2IDEyIDEyQzEyIDcuMTQgMTUuMTQgNCAyMCA0Wk0yMCAyNEMyNi42NiAyNCAzMiAyOS4zQzMyIDM2SDhDOCwyOS4zNCAxMy4zNCAyNCAyMCAyNFoiLz4KPC9zdmc+Cjwvc3ZnPg=='}" 
                             alt="Аватар" style="width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px;">
                        <h3>${chat.title}</h3>
                        <p>Групповой чат</p>
                    </div>
                    <div>
                        <h4>Участники:</h4>
                        <ul>
                            ${chat.participants.map(username => `<li>${users[username]?.nickname || username}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            chatInfoContent.innerHTML = content;
            document.getElementById('chatInfoModal').classList.add('active');
        }

        // Удаление чата
        function deleteChat() {
            if (!currentChatId) {
                alert('Выберите чат для удаления');
                return;
            }
            
            if (!confirm('Вы уверены, что хотите удалить этот чат? История переписки будет очищена.')) {
                return;
            }
            
            // Очищаем сообщения в чате
            chats[currentChatId].messages = [];
            
            // Сохраняем данные
            saveData();
            
            // Обновляем интерфейс
            updateMessages();
            updateChatsList();
            
            alert('Чат очищен');
        }

        // Вспомогательные функции
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function isValidUsername(username) {
            const re = /^[a-zA-Z0-9]+$/;
            return re.test(username);
        }

        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
        }

        function hideError(elementId) {
            const element = document.getElementById(elementId);
            element.style.display = 'none';
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
        }
    </script>
</body>
</html>
